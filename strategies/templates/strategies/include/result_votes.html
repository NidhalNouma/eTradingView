{% load custom_filters %}

<form
  class="flex items-center"
  hx-post="{% url 'result_vote' result.id 'positive' %}"
  hx-target="#result-votes-{{ result.id }}"
>
  {% csrf_token %} {% if user.is_authenticated and subscription %}
  <button type="submit">
    <svg
      class="{% if user in result.positive_votes.all %}fill-text{% else %}fill-text/50{% endif %} w-5 h-5 cursor-pointer"
      stroke-width="0"
      viewBox="0 0 20 20"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z"
        clip-rule="evenodd"
      ></path>
    </svg>
  </button>
  {% elif user.is_authenticated and not subscription %}
  <button
    type="button"
    class=""
    data-modal-target="upgrade-modal"
    data-modal-toggle="upgrade-modal"
  >
    <svg
      class="{% if user in result.positive_votes.all %}fill-text{% else %}fill-text/50{% endif %} w-5 h-5 cursor-pointer"
      stroke-width="0"
      viewBox="0 0 20 20"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z"
        clip-rule="evenodd"
      ></path>
    </svg>
  </button>
  {% else %}
  <a class="" href="{% url 'login' %}">
    <svg
      class="{% if user in result.positive_votes.all %}fill-text{% else %}fill-text/50{% endif %} w-5 h-5 cursor-pointer"
      stroke-width="0"
      viewBox="0 0 20 20"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z"
        clip-rule="evenodd"
      ></path>
    </svg>
  </a>
  {% endif %}
</form>
<span class="text-text/50 text-sm font-semibold px-1"
  >{% with total=result.positive_votes.count|subtract:result.negative_votes.count %} 
  {{ total }} {% endwith %}</span>
<form
  class="flex items-center"
  hx-post="{% url 'result_vote' result.id 'negative' %}"
  hx-target="#result-votes-{{ result.id }}"
>
  {% csrf_token %}{% if user.is_authenticated and subscription %}
  <button type="submit">
    <svg
      class="{% if user in result.negative_votes.all %}fill-text{% else %}fill-text/50{% endif %} w-5 h-5 cursor-pointer"
      stroke-width="0"
      viewBox="0 0 20 20"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v3.586L7.707 9.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 10.586V7z"
        clip-rule="evenodd"
      ></path>
    </svg>
  </button>
  {% elif user.is_authenticated and not subscription %}
  <button
    type="button"
    class=""
    data-modal-target="upgrade-modal"
    data-modal-toggle="upgrade-modal"
  >
  <svg
    class="{% if user in result.negative_votes.all %}fill-text{% else %}fill-text/50{% endif %} w-5 h-5 cursor-pointer"
    stroke-width="0"
    viewBox="0 0 20 20"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v3.586L7.707 9.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 10.586V7z"
      clip-rule="evenodd"
    ></path>
  </svg>
  </button>
  {% else %}
  <a class="" href="{% url 'login' %}">
    <svg
      class="{% if user in result.negative_votes.all %}fill-text{% else %}fill-text/50{% endif %} w-5 h-5 cursor-pointer"
      stroke-width="0"
      viewBox="0 0 20 20"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v3.586L7.707 9.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 10.586V7z"
        clip-rule="evenodd"
      ></path>
    </svg>
  </a>
  {% endif %}
</form>
